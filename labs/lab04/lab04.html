

<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <title>Lab 4: Transformations and KDEs &#8212; Demo Data-8 Book Chapter</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/all.min.css" integrity="sha384-KA6wR/X5RY4zFAHpv/CnoG2UW1uogYfdnP67Uv7eULvTveboZJg0qUpmJZb5VqzN" crossorigin="anonymous">
    <link href="../../_static/css/index.css" rel="stylesheet">
    <link rel="stylesheet" href="../../_static/sphinx-book-theme.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/jupyter-sphinx.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-dropdown.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/panels-bootstrap.min.css" />
    <script id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/sphinx-book-theme.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/language_data.js"></script>
    <script src="../../_static/togglebutton.js"></script>
    <script src="../../_static/clipboard.min.js"></script>
    <script src="../../_static/copybutton.js"></script>
    <script src="../../_static/mystnb.js"></script>
    <script src="../../_static/sphinx-book-theme.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="https://unpkg.com/@jupyter-widgets/html-manager@^0.18.0/dist/embed-amd.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />

    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="docsearch:language" content="en">



  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
<a class="navbar-brand text-wrap" href="../../index.html">
  
  <img src="../../_static/logo.png" class="logo" alt="logo">
  
  
  <h1 class="site-logo" id="site-title">Demo Data-8 Book Chapter</h1>
  
</a>
</div>

<form class="bd-search d-flex align-items-center" action="../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form>

<nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
  
  <ul class="nav sidenav_l1">
  <li class="">
    <a href="../../data8/Estimation.html">Data 8 demo</a>
  </li>
  <li class="">
    <a href="../../ds100/viz_intro.html">Data 100 demo</a>
  </li>
</ul>
</nav>

 <!-- To handle the deprecated key -->

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="row topbar fixed-top container-xl">
    <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show">
    </div>
    <div class="col pl-2 topbar-main">
        
        <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
            data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
            aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
            title="Toggle navigation" data-toggle="tooltip" data-placement="left">
            <i class="fas fa-bars"></i>
            <i class="fas fa-arrow-left"></i>
            <i class="fas fa-arrow-up"></i>
        </button>
        
        <div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    
    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../../_sources/labs/lab04/lab04.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
    
</div>
        <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://github.com/choldgraf/utoronto-demo"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        <a class="issues-button"
            href="https://github.com/choldgraf/utoronto-demo/issues/new?title=Issue%20on%20page%20%2Flabs/lab04/lab04.html&body=Your%20issue%20content%20here."><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Open an issue"><i class="fas fa-lightbulb"></i>open issue</button></a>
        <a class="edit-button" href="https://github.com/choldgraf/utoronto-demo/edit/master/labs/lab04/lab04.ipynb"><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Edit this page"><i class="fas fa-pencil-alt"></i>suggest edit</button></a>
    </div>
</div>


        <!-- Full screen (wrap in <a> to have style consistency -->
        <a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
                data-placement="bottom" onclick="toggleFullScreen()" title="Fullscreen mode"><i
                    class="fas fa-expand"></i></button></a>

        <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/choldgraf/utoronto-demo/master?urlpath=lab/tree/labs/lab04/lab04.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="../../_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        <a class="jupyterhub-button" href="https://utoronto.2i2c.cloud/hub/user-redirect/git-pull?repo=https://github.com/choldgraf/utoronto-demo&urlpath=lab/tree/utoronto-demo/labs/lab04/lab04.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch JupyterHub" data-toggle="tooltip"
                data-placement="left"><img class="jupyterhub-button-logo"
                    src="../../_static/images/logo_jupyterhub.svg"
                    alt="Interact on JupyterHub">JupyterHub</button></a>
        
        
        
    </div>
</div>

    </div>
    <div class="d-none d-md-block col-md-2 bd-toc show">
<div class="tocsection onthispage pt-5 pb-3">
    <i class="fas fa-list"></i> On this page
</div>

<nav id="bd-toc-nav">
    <ul class="nav section-nav flex-column">
    
        <li class="nav-item toc-entry toc-h2">
            <a href="#" class="nav-link">Lab 4: Transformations and KDEs</a><ul class="nav section-nav flex-column">
                
        <li class="nav-item toc-entry toc-h3">
            <a href="#objective" class="nav-link">Objective</a>
        </li>
    
        <li class="nav-item toc-entry toc-h3">
            <a href="#collaboration-policy" class="nav-link">Collaboration Policy</a>
        </li>
    
        <li class="nav-item toc-entry toc-h3">
            <a href="#loading-data" class="nav-link">Loading Data</a>
        </li>
    
            </ul>
        </li>
    
        <li class="nav-item toc-entry toc-h2">
            <a href="#part-1-scaling" class="nav-link">Part 1: Scaling</a><ul class="nav section-nav flex-column">
                
        <li class="nav-item toc-entry toc-h3">
            <a href="#question-1a" class="nav-link">Question 1a</a>
        </li>
    
        <li class="nav-item toc-entry toc-h3">
            <a href="#question-1b" class="nav-link">Question 1b</a>
        </li>
    
        <li class="nav-item toc-entry toc-h3">
            <a href="#question-1c" class="nav-link">Question 1c</a>
        </li>
    
        <li class="nav-item toc-entry toc-h3">
            <a href="#question-1d" class="nav-link">Question 1d</a>
        </li>
    
            </ul>
        </li>
    
        <li class="nav-item toc-entry toc-h2">
            <a href="#part-2-kernel-density-estimation" class="nav-link">Part 2: Kernel Density Estimation</a><ul class="nav section-nav flex-column">
                
        <li class="nav-item toc-entry toc-h3">
            <a href="#question-2a" class="nav-link">Question 2a</a>
        </li>
    
        <li class="nav-item toc-entry toc-h3">
            <a href="#question-2b" class="nav-link">Question 2b</a>
        </li>
    
        <li class="nav-item toc-entry toc-h3">
            <a href="#question-2c" class="nav-link">Question 2c</a>
        </li>
    
            </ul>
        </li>
    
        <li class="nav-item toc-entry toc-h2">
            <a href="#submit" class="nav-link">Submit</a>
        </li>
    
    </ul>
</nav>



<div class="tocsection editthispage">
    <a href="https://github.com/choldgraf/utoronto-demo/edit/master/labs/lab04/lab04.ipynb">
        <i class="fas fa-pencil-alt"></i> Edit this page
    </a>
</div>

    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Initialize OK</span>
<span class="kn">from</span> <span class="nn">client.api.notebook</span> <span class="kn">import</span> <span class="n">Notebook</span>
<span class="n">ok</span> <span class="o">=</span> <span class="n">Notebook</span><span class="p">(</span><span class="s1">&#39;lab04.ok&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="lab-4-transformations-and-kdes">
<h1>Lab 4: Transformations and KDEs<a class="headerlink" href="#lab-4-transformations-and-kdes" title="Permalink to this headline">¶</a></h1>
<div class="section" id="objective">
<h2>Objective<a class="headerlink" href="#objective" title="Permalink to this headline">¶</a></h2>
<p>In this lab you will get some practice plotting, applying data transformations, and working with kernel density estimators.  We will be working with data from the World Bank containing various statistics for countries and territories around the world.</p>
<p><strong>This assignment should be completed and submitted by 11:59 PM on Monday March 2, 2020.</strong></p>
</div>
<div class="section" id="collaboration-policy">
<h2>Collaboration Policy<a class="headerlink" href="#collaboration-policy" title="Permalink to this headline">¶</a></h2>
<p>Data science is a collaborative activity. While you may talk with others about the labs, we ask that you <strong>write your solutions individually</strong>. If you do discuss the assignments with others, please <strong>include their names</strong> in the following cell:</p>
<p><em>List collaborators here</em></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">ds100_utils</span>

<span class="n">plt</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="s1">&#39;fivethirtyeight&#39;</span><span class="p">)</span> <span class="c1"># Use plt.style.available to see more styles</span>
<span class="n">sns</span><span class="o">.</span><span class="n">set</span><span class="p">()</span>
<span class="n">sns</span><span class="o">.</span><span class="n">set_context</span><span class="p">(</span><span class="s2">&quot;talk&quot;</span><span class="p">)</span>
<span class="o">%</span><span class="n">matplotlib</span> <span class="n">inline</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="loading-data">
<h2>Loading Data<a class="headerlink" href="#loading-data" title="Permalink to this headline">¶</a></h2>
<p>Let us load some World Bank data into a pandas.DataFrame object named <code class="docutils literal notranslate"><span class="pre">wb</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">wb</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;data/world_bank_misc.csv&quot;</span><span class="p">,</span> <span class="n">index_col</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">wb</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p>This table contains some interesting columns.  Take a look:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">list</span><span class="p">(</span><span class="n">wb</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="part-1-scaling">
<h1>Part 1: Scaling<a class="headerlink" href="#part-1-scaling" title="Permalink to this headline">¶</a></h1>
<p>In the first part of this assignment we will look at the distribution of values for female adult literacy rate as well as the gross national income per capita. The code below creates a copy of the dataframe that contains only the two Series we want, and then drops all rows that contain null values in either column.</p>
<p><strong>Note:</strong> For this lab we are dropping null values without investigating them further. However, this is generally not the best practice and can severely affect our analyses.</p>
<div class="cell tag_student docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">#creates a dataframe with the appropriate index</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="n">wb</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>

<span class="c1">#copies the Series we want</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;lit&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">wb</span><span class="p">[</span><span class="s1">&#39;Adult literacy rate: Female: </span><span class="si">% a</span><span class="s1">ges 15 and older: 2005-14&#39;</span><span class="p">]</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;inc&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">wb</span><span class="p">[</span><span class="s1">&#39;Gross national income per capita, Atlas method: $: 2016&#39;</span><span class="p">]</span>

<span class="c1">#the line below drops all records that have a NaN value in either column</span>
<span class="n">df</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Original records:&quot;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">wb</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Final records:&quot;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="question-1a">
<h2>Question 1a<a class="headerlink" href="#question-1a" title="Permalink to this headline">¶</a></h2>
<p>Suppose we wanted to build a histogram of our data to understand the distribution of literacy rates and income per capita individually. We can use <code class="docutils literal notranslate"><span class="pre">countplot</span></code> in seaborn to create bar charts from categorical data.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>

<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">countplot</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;lit&#39;</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Adult literacy rate: Female: </span><span class="si">% a</span><span class="s2">ges 15 and older: 2005-14&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;World Bank Female Adult Literacy Rate&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">countplot</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;inc&#39;</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Gross national income per capita, Atlas method: $: 2016&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;World Bank Gross National Income Per Capita&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p>In the cell below, explain why <code class="docutils literal notranslate"><span class="pre">countplot</span></code> is NOT the right tool for visualizing the distribution of our data. Discuss with your neighbors as well!</p>
<!--
BEGIN QUESTION
name: q1a
--><p><em>Write your answer here, replacing this text.</em></p>
</div>
<div class="section" id="question-1b">
<h2>Question 1b<a class="headerlink" href="#question-1b" title="Permalink to this headline">¶</a></h2>
<p>In the cell below, create a plot of literacy rate and income per capita using the <code class="docutils literal notranslate"><span class="pre">distplot</span></code> function. As above, you should have two subplots, where the left subplot is literacy, and the right subplot is income. When you call <code class="docutils literal notranslate"><span class="pre">distplot</span></code>, set the <code class="docutils literal notranslate"><span class="pre">kde</span></code> parameter to false, e.g. <code class="docutils literal notranslate"><span class="pre">distplot(s,</span> <span class="pre">kde=False)</span></code>.</p>
<p>Don’t forget to title the plot and label axes!</p>
<p><strong>Hint:</strong> <em>Copy and paste from above to start.</em></p>
<!--
BEGIN QUESTION
name: q1b1
--><div class="cell tag_student docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">...</span>
</pre></div>
</div>
</div>
</div>
<p>You should see histograms that show the counts of how many data points appear in each bin. <code class="docutils literal notranslate"><span class="pre">distplot</span></code> uses a heuristic called the Freedman-Diaconis rule to automatically identify the best bin sizes, though it is possible to set the bins yourself (we won’t).</p>
<p>In the cell below, try creating the exact same plot again, but this time set the <code class="docutils literal notranslate"><span class="pre">kde</span></code> parameter to False and the <code class="docutils literal notranslate"><span class="pre">rug</span></code> parameter to True.</p>
<!--
BEGIN QUESTION
name: q1b2
--><div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">...</span>
</pre></div>
</div>
</div>
</div>
<p>Above, you should see little lines at the bottom of the plot showing the actual data points. In the cell below, let’s do one last tweak and plot with the <code class="docutils literal notranslate"><span class="pre">kde</span></code> parameter set to True.</p>
<!--
BEGIN QUESTION
name: q1b3
--><div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">...</span>
</pre></div>
</div>
</div>
</div>
<p>You should see roughly the same histogram as before. However, now you should see an overlaid smooth line. This is the kernel density estimate discussed in class.</p>
<p>Observations:</p>
<ul class="simple">
<li><p>You’ll also see that the y-axis value is no longer the count. Instead it is a value such that the total area under the KDE curve is 1 <em>and</em> the total area in the histogram is 1. The KDE is a smooth estimate of the distribution of the given variable.</p></li>
<li><p>The KDE is just an estimate, as is the histogram. Notice that it assigns a large fraction of its area to values in the 100-120% literacy rate. This is definitely an impossibility.</p></li>
</ul>
<p>We’ll talk more about KDEs later in this lab.</p>
</div>
<div class="section" id="question-1c">
<h2>Question 1c<a class="headerlink" href="#question-1c" title="Permalink to this headline">¶</a></h2>
<p>Looking at the income data, it is difficult to see the distribution among low income countries because they are all scrunched up at the left side of the plot. The KDE also has a problem where the density function has a lot of area below 0.</p>
<p>When we logarithmically transform the <code class="docutils literal notranslate"><span class="pre">inc</span></code> data that gives us a more symmetric distribution of values. This can make it easier to see patterns.</p>
<p>In addition, summary statistics like the mean and standard deviation (square-root of the variance) are more stable with symmetric distributions.</p>
<p>In the cell below, make a distribution plot of <code class="docutils literal notranslate"><span class="pre">inc</span></code> with the data transformed using <code class="docutils literal notranslate"><span class="pre">np.log10</span></code> and <code class="docutils literal notranslate"><span class="pre">kde=True</span></code>. Be sure to correct the axis label using <code class="docutils literal notranslate"><span class="pre">plt.xlabel</span></code>. If you want to see the exact counts, just set <code class="docutils literal notranslate"><span class="pre">kde=False</span></code>.</p>
<!--
BEGIN QUESTION
name: q1c
--><div class="cell tag_student docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">...</span>
</pre></div>
</div>
</div>
</div>
<p>When a distribution has a long right tail, a log-transformation often does a good job of symmetrizing the distribution, as it did here.  Long right tails are common with variables that have a lower limit on the values.</p>
<p>On the other hand, long left tails are common with distributions of variables that have an upper limit, such as percentages (can’t be higher than 100%) and GPAs (can’t be higher than 4).  That is the case for the literacy rate. Typically taking a power-transformation such
as squaring or cubing the values can help symmetrize the left skew distribution.</p>
<p>In the cell below, make a distribution plot of <code class="docutils literal notranslate"><span class="pre">lit</span></code> with the data transformed using a power, i,e., raise <code class="docutils literal notranslate"><span class="pre">lit</span></code> to the 2nd, 3rd, and 4th power. Select the transformation that you think is best. Be sure to set <code class="docutils literal notranslate"><span class="pre">kde=True</span></code> and correct the axis label using <code class="docutils literal notranslate"><span class="pre">plt.xlabel</span></code>.</p>
<!--
BEGIN QUESTION
name: q1c2
--><div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">...</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="question-1d">
<h2>Question 1d<a class="headerlink" href="#question-1d" title="Permalink to this headline">¶</a></h2>
<p>If we want to examine the relationship between the female adult literacy rate and the gross national income per capita is, we need to make a scatter plot.</p>
<p>In the cell below, create a scatter plot of income per capita and literacy rate using the <code class="docutils literal notranslate"><span class="pre">sns.scatterplot</span></code> function. Make  sure to label both axes using <code class="docutils literal notranslate"><span class="pre">plt.xlabel</span></code> and <code class="docutils literal notranslate"><span class="pre">plt.ylabel</span></code>.</p>
<!--
BEGIN QUESTION
name: q1d
--><div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">...</span>
</pre></div>
</div>
</div>
</div>
<p>We can better assess the relationship between two variables when they have been straightened because it is easier for us to recognize linearity.</p>
<p>In the cell below, create a scatter plot of log-transformed income per capita against literacy rate. Make  sure to label both axes using <code class="docutils literal notranslate"><span class="pre">plt.xlabel</span></code> and <code class="docutils literal notranslate"><span class="pre">plt.ylabel</span></code>.</p>
<!--
BEGIN QUESTION
name: q1d2
--><div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">...</span>
</pre></div>
</div>
</div>
</div>
<p>This scatter plot looks better. The relationship is closer to linear.</p>
<p>We can think of the log-linear relationship between x and y, as follows: a constant change in x corresponds to a percent (scaled) change in y.</p>
<p>We can also see that the long left tail of literacy is represented in this plot by a lot of the points being bunched up near 100. Try squaring literacy and taking the log of income. Does the plot look better?</p>
<!--
BEGIN QUESTION
name: q1d3
--><div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">...</span>
</pre></div>
</div>
</div>
</div>
<p>Choosing the best transformation for a relationship is often a balance between keeping the model simple and straightening the scatter plot.</p>
</div>
</div>
<div class="section" id="part-2-kernel-density-estimation">
<h1>Part 2: Kernel Density Estimation<a class="headerlink" href="#part-2-kernel-density-estimation" title="Permalink to this headline">¶</a></h1>
<p>In this part of the lab you will develop a deeper understanding of how kernel destiny estimation works. This section assumes you watched Lectures 9 and 10 and are familiar with the basic idea of the KDE.</p>
<p>Suppose we have 3 data points with values 2, 4, and 9. We can compute the (useless) histogram as shown below.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">data3pts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">9</span><span class="p">])</span>
<span class="n">sns</span><span class="o">.</span><span class="n">distplot</span><span class="p">(</span><span class="n">data3pts</span><span class="p">,</span> <span class="n">kde</span> <span class="o">=</span> <span class="kc">False</span><span class="p">);</span>
</pre></div>
</div>
</div>
</div>
<p>By setting <code class="docutils literal notranslate"><span class="pre">kde=True</span></code>, we can see a kernel density estimate of the data.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">distplot</span><span class="p">(</span><span class="n">data3pts</span><span class="p">,</span> <span class="n">kde</span> <span class="o">=</span> <span class="kc">True</span><span class="p">);</span>
</pre></div>
</div>
</div>
</div>
<p>One question you might be wondering is how the kernel density estimator decides how “wide” each point should be. It turns out this is a parameter you can set called <code class="docutils literal notranslate"><span class="pre">bw</span></code>, which stands for bandwith. For example, the code below gives a bandwith value of 0.5 to each data point. You’ll see the resulting kde is quite different. Try experimenting with different values of bandwidth and see what happens.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">distplot</span><span class="p">(</span><span class="n">data3pts</span><span class="p">,</span> <span class="n">kde</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">kde_kws</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;bw&quot;</span><span class="p">:</span> <span class="mf">0.5</span><span class="p">});</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="question-2a">
<h2>Question 2a<a class="headerlink" href="#question-2a" title="Permalink to this headline">¶</a></h2>
<p>As mentioned in class, the kernel density estimate (KDE) is just the sum of a bunch of copies of the kernel, each centered on our data points. The default kernel used by the <code class="docutils literal notranslate"><span class="pre">distplot</span></code> function is the Guassian kernel, given by:</p>
<div class="math notranslate nohighlight">
\[\Large
K_\alpha(x, z) = \frac{1}{\sqrt{2 \pi \alpha^2}} \exp\left(-\frac{(x - z)^2}{2  \alpha ^2} \right)
\]</div>
<p>In Python code, this function is given as below, where <code class="docutils literal notranslate"><span class="pre">alpha</span></code> is the smoothing or bandwidth parameter <span class="math notranslate nohighlight">\(\alpha\)</span> for the KDE, <code class="docutils literal notranslate"><span class="pre">z</span></code> is the center of the Gaussian (i.e. a data point or an array of data points), and <code class="docutils literal notranslate"><span class="pre">x</span></code> is an array of values of the variable whose distribution we are plotting.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">gaussian_kernel</span><span class="p">(</span><span class="n">alpha</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">z</span><span class="p">):</span>
    <span class="k">return</span> <span class="mf">1.0</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mf">2.</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">alpha</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="n">z</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">/</span> <span class="p">(</span><span class="mf">2.0</span> <span class="o">*</span> <span class="n">alpha</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<p>For example, we can plot the Gaussian kernel centered at 9 with <span class="math notranslate nohighlight">\(\alpha\)</span> = 0.5 as below:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">xs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">200</span><span class="p">)</span>
<span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span>
<span class="n">kde_curve</span> <span class="o">=</span> <span class="p">[</span><span class="n">gaussian_kernel</span><span class="p">(</span><span class="n">alpha</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="mi">9</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">xs</span><span class="p">]</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xs</span><span class="p">,</span> <span class="n">kde_curve</span><span class="p">);</span>
</pre></div>
</div>
</div>
</div>
<p>In the cell below, plot the 3 kernel density functions corresponding to our 3 data points on the same axis. Use an <code class="docutils literal notranslate"><span class="pre">alpha</span></code> value of 0.5. Recall that our three data points are 2, 4, and 9.</p>
<p><strong>Note:</strong> Make sure to normalize your kernels! This means that the area under each of your kernels should be <span class="math notranslate nohighlight">\(\frac{1}{3}\)</span> since there are three data points.</p>
<p>You don’t have to use the following hints, but they might be helpful in simplifying your code.</p>
<p><strong>Hint:</strong> The <code class="docutils literal notranslate"><span class="pre">gaussian_kernel</span></code> function can also take a numpy array as an argument for <code class="docutils literal notranslate"><span class="pre">z</span></code>.</p>
<p><strong>Hint:</strong> To plot multiple plots at once, you can use <code class="docutils literal notranslate"><span class="pre">plt.plot(xs,</span> <span class="pre">y)</span></code> with a two dimensional array as <code class="docutils literal notranslate"><span class="pre">y</span></code>.</p>
<!--
BEGIN QUESTION
name: q2a1
--><div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">...</span>
</pre></div>
</div>
</div>
</div>
<p>In the cell below, create a plot showing the sum of all three of the kernels above. Your plot should closely resemble the kde shown when you called <code class="docutils literal notranslate"><span class="pre">distplot</span></code> function with bandwidth 0.5 earlier. The area under your final curve should be 1 since the area under each of the three normalized kernels is <span class="math notranslate nohighlight">\(\frac{1}{3}\)</span>.</p>
<p><strong>Hint:</strong> Consider using <code class="docutils literal notranslate"><span class="pre">np.sum</span></code> with the argument <code class="docutils literal notranslate"><span class="pre">axis</span> <span class="pre">=</span> <span class="pre">1</span></code>.* For a two dimensional numpy array, this will sum the array across the rows. For an example, see the “along an axis” entry in the numpy <a class="reference external" href="https://docs.scipy.org/doc/numpy-1.13.0/glossary.html">glossary</a>.</p>
<!--
BEGIN QUESTION
name: q2a2
--><div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">...</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="question-2b">
<h2>Question 2b<a class="headerlink" href="#question-2b" title="Permalink to this headline">¶</a></h2>
<p>Recall that earlier we plotted the kernel density estimation for the logarithm of the income data, as shown again below.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ax</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">distplot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;inc&#39;</span><span class="p">]),</span> <span class="n">hist</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;World Bank Gross National Income Per Capita&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Log Gross national income per capita, Atlas method: $: 2016&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
</div>
<p>In the cell below, make a similar plot using your technique from question 2a. Give an estimate of the <span class="math notranslate nohighlight">\(\alpha\)</span> value chosen by the <code class="docutils literal notranslate"><span class="pre">sns.distplot</span></code> function by tweaking your <code class="docutils literal notranslate"><span class="pre">alpha</span></code> value until your plot looks almost the same. Make sure to normalize your graph, so the area under the curve is 1.</p>
<!--
BEGIN QUESTION
name: q2b
--><div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">xs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">200</span><span class="p">)</span>
<span class="o">...</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="question-2c">
<h2>Question 2c<a class="headerlink" href="#question-2c" title="Permalink to this headline">¶</a></h2>
<p>In your answers above, you hard coded a lot of your work. In this problem, you’ll build a more general kernel density estimator function.</p>
<p>Implement the KDE function which computes:</p>
<div class="math notranslate nohighlight">
\[\Large
f_\alpha(x) = \frac{1}{n} \sum_{i=1}^n K_\alpha(x, z_i)
\]</div>
<p>Where <span class="math notranslate nohighlight">\(z_i\)</span> are the data, <span class="math notranslate nohighlight">\(\alpha\)</span> is a parameter to control the smoothness, and <span class="math notranslate nohighlight">\(K_\alpha\)</span> is the kernel density function passed as <code class="docutils literal notranslate"><span class="pre">kernel</span></code>.</p>
<!--
BEGIN QUESTION
name: q2c
--><div class="cell tag_student docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">kde</span><span class="p">(</span><span class="n">kernel</span><span class="p">,</span> <span class="n">alpha</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Compute the kernel density estimate for the single query point x.</span>

<span class="sd">    Args:</span>
<span class="sd">        kernel: a kernel function with 3 parameters: alpha, x, data</span>
<span class="sd">        alpha: the smoothing parameter to pass to the kernel</span>
<span class="sd">        x: a single query point (in one dimension)</span>
<span class="sd">        data: a numpy array of data points</span>

<span class="sd">    Returns:</span>
<span class="sd">        The smoothed estimate at the query point x</span>
<span class="sd">    &quot;&quot;&quot;</span>    
    <span class="o">...</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ok</span><span class="o">.</span><span class="n">grade</span><span class="p">(</span><span class="s2">&quot;q2c&quot;</span><span class="p">);</span>
</pre></div>
</div>
</div>
</div>
<p>Assuming you implemented <code class="docutils literal notranslate"><span class="pre">kde</span></code> correctly, the code below should generate the <code class="docutils literal notranslate"><span class="pre">kde</span></code> of the log of the income data as before.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;trans_inc&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;inc&#39;</span><span class="p">])</span>
<span class="n">xs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;trans_inc&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;trans_inc&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">(),</span> <span class="mi">1000</span><span class="p">)</span>
<span class="n">curve</span> <span class="o">=</span> <span class="p">[</span><span class="n">kde</span><span class="p">(</span><span class="n">gaussian_kernel</span><span class="p">,</span> <span class="n">alpha</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;trans_inc&#39;</span><span class="p">])</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">xs</span><span class="p">]</span>
<span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;trans_inc&#39;</span><span class="p">],</span> <span class="n">normed</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;orange&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;World Bank Gross National Income Per Capita&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Log Gross national income per capita, Atlas method: $: 2016&#39;</span><span class="p">);</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xs</span><span class="p">,</span> <span class="n">curve</span><span class="p">,</span> <span class="s1">&#39;k-&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
</div>
<p>And the code below should show a 3 x 3 set of plots showing the output of the kde for different <code class="docutils literal notranslate"><span class="pre">alpha</span></code> values.</p>
<div class="cell tag_student docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span><span class="mi">15</span><span class="p">))</span>
<span class="n">alphas</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mf">0.2</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">)</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">alpha</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">alphas</span><span class="p">):</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">xs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;trans_inc&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;trans_inc&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">(),</span> <span class="mi">1000</span><span class="p">)</span>
    <span class="n">curve</span> <span class="o">=</span> <span class="p">[</span><span class="n">kde</span><span class="p">(</span><span class="n">gaussian_kernel</span><span class="p">,</span> <span class="n">alpha</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;trans_inc&#39;</span><span class="p">])</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">xs</span><span class="p">]</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;trans_inc&#39;</span><span class="p">],</span> <span class="n">normed</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;orange&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xs</span><span class="p">,</span> <span class="n">curve</span><span class="p">,</span> <span class="s1">&#39;k-&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p>Let’s take a look at another kernel, the Boxcar kernel.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">boxcar_kernel</span><span class="p">(</span><span class="n">alpha</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">z</span><span class="p">):</span>
    <span class="k">return</span> <span class="p">(((</span><span class="n">x</span><span class="o">-</span><span class="n">z</span><span class="p">)</span><span class="o">&gt;=-</span><span class="n">alpha</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span><span class="o">&amp;</span><span class="p">((</span><span class="n">x</span><span class="o">-</span><span class="n">z</span><span class="p">)</span><span class="o">&lt;=</span><span class="n">alpha</span><span class="o">/</span><span class="mi">2</span><span class="p">))</span><span class="o">/</span><span class="n">alpha</span>
</pre></div>
</div>
</div>
</div>
<p>Run the cell below to enable interactive plots. It should give you a green ‘OK’ when it’s finished.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>from ipywidgets import interact
!jupyter nbextension enable --py widgetsnbextension
</pre></div>
</div>
</div>
</div>
<p>Now, we can plot the Boxcar and Gaussian kernel functions to see what they look like.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">1000</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">f</span><span class="p">(</span><span class="n">alpha</span><span class="p">):</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">boxcar_kernel</span><span class="p">(</span><span class="n">alpha</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Boxcar&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">gaussian_kernel</span><span class="p">(</span><span class="n">alpha</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Gaussian&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s1">&#39;Kernel Function&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="n">interact</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mf">0.1</span><span class="p">));</span>
</pre></div>
</div>
</div>
</div>
<p>Using the interactive plot below compare the the two kernel techniques:  (Generating the KDE plot is slow, so you may expect some latency after you move the slider)</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">xs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;trans_inc&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;trans_inc&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">(),</span> <span class="mi">1000</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">f</span><span class="p">(</span><span class="n">alpha_g</span><span class="p">,</span> <span class="n">alpha_b</span><span class="p">):</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;trans_inc&#39;</span><span class="p">],</span> <span class="n">normed</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;orange&#39;</span><span class="p">)</span>
    <span class="n">g_curve</span> <span class="o">=</span> <span class="p">[</span><span class="n">kde</span><span class="p">(</span><span class="n">gaussian_kernel</span><span class="p">,</span> <span class="n">alpha_g</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;trans_inc&#39;</span><span class="p">])</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">xs</span><span class="p">]</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xs</span><span class="p">,</span> <span class="n">g_curve</span><span class="p">,</span> <span class="s1">&#39;k-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Gaussian&#39;</span><span class="p">)</span>
    <span class="n">b_curve</span> <span class="o">=</span> <span class="p">[</span><span class="n">kde</span><span class="p">(</span><span class="n">boxcar_kernel</span><span class="p">,</span> <span class="n">alpha_b</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;trans_inc&#39;</span><span class="p">])</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">xs</span><span class="p">]</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xs</span><span class="p">,</span> <span class="n">b_curve</span><span class="p">,</span> <span class="s1">&#39;r-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Boxcar&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s1">&#39;Kernel Function&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="n">interact</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">alpha_g</span><span class="o">=</span><span class="p">(</span><span class="mf">0.01</span><span class="p">,</span><span class="o">.</span><span class="mi">5</span><span class="p">,</span><span class="mf">0.01</span><span class="p">),</span> <span class="n">alpha_b</span><span class="o">=</span><span class="p">(</span><span class="mf">0.01</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mf">0.1</span><span class="p">));</span>
</pre></div>
</div>
</div>
</div>
<p>Briefly compare and contrast the Gaussian and Boxcar kernels in the cell below. How do the two kernels relate with each other for the same alpha value?</p>
<p><strong>Congrats!</strong> You are finished with this assignment.</p>
</div>
</div>
<div class="section" id="submit">
<h1>Submit<a class="headerlink" href="#submit" title="Permalink to this headline">¶</a></h1>
<p>Make sure you have run all cells in your notebook in order before running the cell below, so that all images/graphs appear in the output.
<strong>Please save before submitting!</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Save your notebook first, then run this cell to submit.</span>
<span class="n">ok</span><span class="o">.</span><span class="n">submit</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</div>


              </div>
              
        </div>
    </div>
    
    
    <div class='prev-next-bottom'>
        

    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
            &copy; Copyright 2020.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>

    <script src="../../_static/js/index.js"></script>
    
  </body>
</html>